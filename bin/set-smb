#!/bin/sh

. $(dirname $0)/env.conf > /dev/null

file=/etc/samba/smb.conf
config=${HOME}/opt/${tool_name}/conf/samba/smb.conf

if [ ! -f ${file} ]; then
    echo "Samba is not installed."
    exit
fi

if [ -z "${1}" ]; then
    echo "Usage: $(basename $0) <username>"
    exit
fi

if [ ! -f ${file}.ori ]; then
    echo "Creating ${file}.ori..."
    sudo cp -p ${file} ${file}.ori
else
    echo "${file}.ori exists."
fi

sudo sh -c "cat ${file}.ori ${config} > ${file}"
echo "${file} has been generated."
ls -la ${file}*

sudo smbpasswd -a ${1}
